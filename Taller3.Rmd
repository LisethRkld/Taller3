---
title: "Taller3"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

_a) Indicar razonadamente si es de ciclo máximo._
Para determinar si un generador congruencial tiene periodo máximo ($m$) usamos el Teorema de Hull y Dobell. Si se cumplen las siguientes condiciones entonces $p=m$.
  1) ¿$c$ y $m$ son primos relativos?
  Vemos que $c=1$ y $a=65$, por lo tanto sí son primos relativos.
  2) ¿Es $a-1$ múltiplo de todos los factores primos de $m$?
  Primero tenemos los factores primos de $m$ son $

```{r}
library("numbers")
primeFactors(2048)
```
  Dado que $a-1=64$ es un número par, es múltiplo de el único factor primo de $m$, que es $2$. Por tanto la segunda condición se cumple.
  3) Si $m$ es múltiplo de $4$, entonces $a-1$ también lo es.
  Notemos que $m=2048=4*512$, es decir es un múltiplo de 4.
  Ahora, tenemos que $a-1=64=4*16$, es decir que también es un múltiplo de 4, cumpliendo así la condición 3).
  Así, el generador congruencial presentado cumple con las condiciones del Teorema de Hull y Dobell, por lo tanto presenta un periodo máximo $p=2048$

_b) Generar 1000 valores tomando como semilla inicial el n de grupo multiplicado por 100 y obtener el tiempo de CPU. Representar gráficamente el ajuste a la densidad teórica y realizar el correspondiente contraste de Kolmogorov-Smirnov._

```{r}
Ejer <- function(x=1000){
  c <- replicate(x,0)
  for( n in 1:x){
initRANDC(semilla=n*100,a=65,c=1,m=2048)
c[n] <- RANDCN(1)
  }
  return(c)}
tiempo <- system.time(u <- Ejer(1000)) 

```

Veamos la representación gráfica del ajuste a la densidad teórica
```{r}
hist(u)
abline(h=1)
```
Mientras que en la distribución empírica
```{r}
curve(ecdf(u)(x), type = "s", lwd = 2)
curve(punif(x, 0, 1), add = TRUE)
```


Contraste de Kolmogorov-Smirnov
```{r}
ks.test(u, "punif", 0, 1)
```


